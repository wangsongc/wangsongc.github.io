(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{418:function(e,n,t){"use strict";t.r(n);var a=t(56),o=Object(a.a)({},(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"upgrade-to-vue3-by-vue-codemod"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#upgrade-to-vue3-by-vue-codemod"}},[e._v("#")]),e._v(" Upgrade to Vue3 by vue-codemod")]),e._v(" "),t("h2",{attrs:{id:"summary"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#summary"}},[e._v("#")]),e._v(" Summary")]),e._v(" "),t("p",[e._v("It has been half a year since the release of Vue3, meanwhile, LTS support for Vue2 will be phased out in 18 months. How to migrate the existing Vue2 project to Vue3 has become an issue of concern to everyone. Although Vue.js team has released a detailed migration guidance, the workload of source code upgrade and migration in practical projects is relatively large. To reduce repetitive work, we recommend a migration tool called "),t("a",{attrs:{href:"https://github.com/originjs/vue-codemod",target:"_blank",rel:"noopener noreferrer"}},[e._v("originjs/vue-codemod"),t("OutboundLink")],1),e._v(", which can directly upgrade most of the Vue2 syntax to Vue3 syntax. With "),t("code",[e._v("vue-codemod")]),e._v(" transformation and a small amount of manual modification, users can complete the smooth migration from Vue2 to Vue3.")]),e._v(" "),t("blockquote",[t("p",[e._v("⚠️Attention: Since the "),t("a",{attrs:{href:"https://github.com/vuejs/vue-codemod",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("vue-codemod")]),t("OutboundLink")],1),e._v(" from Vue.js team has not been maintained for some time, the following repo is forked from Vue.js team. We are continuing to develop new features in the fork repo.")])]),e._v(" "),t("p",[e._v("Demo project address："),t("a",{attrs:{href:"https://github.com/originjs/vue2-element-touzi-admin/tree/to-vue3",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue2-element-touzi-admin"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"migration-steps"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#migration-steps"}},[e._v("#")]),e._v(" Migration Steps")]),e._v(" "),t("h3",{attrs:{id:"step1-upgrade-the-source-code-by-vue-codemod"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step1-upgrade-the-source-code-by-vue-codemod"}},[e._v("#")]),e._v(" Step1："),t("a",{attrs:{href:"https://github.com/originjs/vue2-element-touzi-admin/commit/21aeb41bf8595a7a6323a92ed9326cec4c7f5955",target:"_blank",rel:"noopener noreferrer"}},[e._v("Upgrade the source code by "),t("code",[e._v("vue-codemod")]),t("OutboundLink")],1)]),e._v(" "),t("blockquote",[t("p",[e._v("⚠️Attention: "),t("code",[e._v("vue-codemod")]),e._v(" modify the file in the source path. If you haven't use version control tools like Git or SVN, please back up your code in advance.")])]),e._v(" "),t("p",[e._v("Command：")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("npx vue-codemod src -a\n")])])]),t("p",[e._v("First we apply "),t("code",[e._v("vue-codemod")]),e._v(" to auto upgrade the source code. Hers is the transformation log. Users can figure out which rules was executed and which files are modified.")]),e._v(" "),t("div",{staticClass:"language-cmd extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("npx vue-codemod src -a\nWarning!!\nThis tool may overwrite files.\npress enter or enter yes or enter Y to continue:\nProcessing use new-component-api transformation: 2.344s\nProcessing use new-global-api transformation: 1.370s\nProcessing use vue-router-v4 transformation: 563.495ms\nProcessing use vuex-v4 transformation: 541.71ms\nProcessing use rename-lifecycle transformation: 605.352ms\nProcessing use add-emit-declaration transformation: 879.03ms\nProcessing use vue-i18n-v9 transformation: 507.606ms\nProcessing use element-plus-import transformation: 524.572ms\nProcessing use router-update-addRoute transformation: 591.202ms\nProcessing use const-app transformation: 614.617ms\nProcessing use slot-attribute transformation: 440.388ms\nProcessing use slot-scope-attribute transformation: 162.384ms\nProcessing use v-for-template-key transformation: 163.131ms\nProcessing use v-bind-sync transformation: 102.651ms\nProcessing use remove-v-on-native transformation: 132.229ms\nProcessing use router-view-keep-alive-transition transformation: 130.557ms\n--------------------------------------------------\nProcessed file:\nsrc/utils/mUtils.js\nsrc/components/iconSvg/index.js\nsrc/main.js\nsrc/lang/index.js\nsrc/router/index.js\nsrc/store/index.js\nsrc/components/echarts/barChart.vue\nsrc/components/echarts/lineChart.vue\nsrc/components/echarts/pieChart.vue\nsrc/components/echarts/radarChart.vue\nsrc/page/fundData/incomePayPosition.vue\nsrc/components/pagination/index.vue\nsrc/page/fundList/components/addFundDialog.vue\nsrc/page/fundList/components/searchItem.vue\nsrc/page/permission/components/SwitchRoles.vue\nsrc/page/share/components/hengShare.vue\nsrc/page/share/components/infoShare.vue\nsrc/page/share/components/inviteShare.vue\nsrc/page/share/components/jianshuLeftShare.vue\nsrc/page/share/components/jianshuShare.vue\nsrc/page/share/components/juejinShare.vue\nsrc/page/share/components/sinaShare.vue\nsrc/page/share/components/wxCodeModal.vue\nsrc/page/share/components/yanShare.vue\nsrc/permission.js\nsrc/utils/axios.js\nsrc/layout/bread.vue\nsrc/layout/content.vue\nsrc/layout/footerNav.vue\nsrc/layout/headNav.vue\nsrc/layout/home.vue\nsrc/layout/leftMenu.vue\nsrc/layout/topMenu.vue\nsrc/page/fundData/fundPosition.vue\nsrc/page/fundData/typePosition.vue\nsrc/page/fundList/chinaTabsList.vue\nsrc/page/fundList/fundList.vue\nsrc/page/infoManage/infoModify.vue\nsrc/page/infoManage/infoShow.vue\nsrc/page/permission/directive.vue\nsrc/page/userList/userList.vue\nsrc/page/fundList/moneyData/index.vue\nsrc/page/index/components/cardList.vue\nsrc/page/index/components/commentList.vue\nsrc/page/index/components/logList.vue\nsrc/page/index/components/salesTable.vue\nsrc/page/fundList/components/chinaTabsTable.vue\nsrc/page/login.vue\npackage.json\nProcessed 49 files\n79 places need to be transformed\n71 places was transformed\nThe transformation rate is 89.87%\nThe transformation stats:\n\n╔═══════════════════════════════════╤═══════╗\n║ Rule Names                        │ Count ║\n╟───────────────────────────────────┼───────╢\n║ new-component-api                 │   1   ║\n║ new-global-api                    │   1   ║\n║ vue-router-v4                     │   1   ║\n║ vuex-v4                           │   1   ║\n║ rename-lifecycle                  │   5   ║\n║ add-emit-declarations             │  13   ║\n║ vue-i18n-v9                       │   1   ║\n║ element-ui-upgrade                │   6   ║\n║ const-app                         │   1   ║\n║ slot-attribute                    │  15   ║\n║ slot-scope-attribute              │  16   ║\n║ v-for-template-key                │   3   ║\n║ v-bind-sync                       │   2   ║\n║ remove-v-on-native                │   3   ║\n║ router-view-keep-alive-transition │   1   ║\n║ package transformation            │   1   ║\n╚═══════════════════════════════════╧═══════╝\n\nThe list that you need to migrate your codes manually:\nindex: 1\n{\n  path: 'src/main.js',\n  position: '[7,0]',\n  name: 'remove Vue(global api)',\n  suggest: \"The rule of thumb is any APIs that globally mutate Vue's behavior are now moved to the app instance. \",\n  website: 'https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp'\n}\nindex: 2\n{\n  path: 'src/main.js',\n  position: '[22,0]',\n  name: 'remove Vue(global api)',\n  suggest: \"The rule of thumb is any APIs that globally mutate Vue's behavior are now moved to the app instance. \",\n  website: 'https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp'\n}\nindex: 3\n{\n  path: 'src/lang/index.js',\n  position: '[5,41]',\n  name: 'remove Vue(global api)',\n  suggest: \"The rule of thumb is any APIs that globally mutate Vue's behavior are now moved to the app instance. \",\n  website: 'https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp'\n}\nindex: 4\n{\n  path: 'src/router/index.js',\n  position: '[6,41]',\n  name: 'remove Vue(global api)',\n  suggest: \"The rule of thumb is any APIs that globally mutate Vue's behavior are now moved to the app instance. \",\n  website: 'https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp'\n}\nindex: 5\n{\n  path: 'src/store/index.js',\n  position: '[4,4]',\n  name: 'remove Vue(global api)',\n  suggest: \"The rule of thumb is any APIs that globally mutate Vue's behavior are now moved to the app instance. \",\n  website: 'https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp'\n}\nindex: 6\n{\n  path: 'src/directive/permission/index.js',\n  position: '[4,2]',\n  name: 'remove Vue(global api)',\n  suggest: \"The rule of thumb is any APIs that globally mutate Vue's behavior are now moved to the app instance. \",\n  website: 'https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp'\n}\nindex: 7\n{\n  path: 'src/directive/permission/index.js',\n  position: '[9,2]',\n  name: 'remove Vue(global api)',\n  suggest: \"The rule of thumb is any APIs that globally mutate Vue's behavior are now moved to the app instance. \",\n  website: 'https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp'\n}\nindex: 8\n{\n  path: 'src/router/index.js',\n  position: '[280,6]',\n  name: 'remove * routes',\n  suggest: 'Catch all routes (*, /*) must now be defined using a parameter with a custom regex: ',\n  website: 'https://next.router.vuejs.org/guide/migration/index.html#removal-of-the-fallback-option'\n}\n")])])]),t("h3",{attrs:{id:"step-2-upgrade-elment-ui-to-element-plus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-2-upgrade-elment-ui-to-element-plus"}},[e._v("#")]),e._v(" Step 2："),t("a",{attrs:{href:"https://github.com/originjs/vue2-element-touzi-admin/commit/8cddf35dcf04165fbf997e378205c5428dcb5e7f",target:"_blank",rel:"noopener noreferrer"}},[e._v("Upgrade elment-ui to element-plus"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("The biggest limitation of Vue3 migration is the dependencies. If some components in your source code don't support Vue3, we suggest your project remain unchanged until the Vue3 supported version release.")]),e._v(" "),t("h3",{attrs:{id:"step-3-fix-errors-or-warnings-from-global-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-3-fix-errors-or-warnings-from-global-api"}},[e._v("#")]),e._v(" Step 3："),t("a",{attrs:{href:"https://github.com/originjs/vue2-element-touzi-admin/commit/c1a7288299f80e23d5b1ad32f111ee10564ad8bd",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fix errors or warnings from Global API"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("In some practical projects, we find some Global API can not be modified precisely, which need to be modified manually according to the warning message from console")]),e._v(" "),t("h3",{attrs:{id:"step-4-fix-errors-or-warnings-from-vue-router"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-4-fix-errors-or-warnings-from-vue-router"}},[e._v("#")]),e._v(" Step 4："),t("a",{attrs:{href:"https://github.com/originjs/vue2-element-touzi-admin/commit/a5c95632e44877360be95014e74229ab13e50664",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fix errors or warnings from Vue router"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("code",[e._v("vue-codemod")]),e._v(" can migrate most of Vue router 3 syntax to router 4, but there are still some breaking change need to be modified manually according to our manual migration guide.")]),e._v(" "),t("h3",{attrs:{id:"step-5-fix-warnings-in-browser"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-5-fix-warnings-in-browser"}},[e._v("#")]),e._v(" Step 5："),t("a",{attrs:{href:"https://github.com/originjs/vue2-element-touzi-admin/commit/7a123320a0d0edf32baa09534c2f7df6664ec730",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fix warnings in browser"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("At this moment the whole project is runnable. We can also fix some warnings from the browser to make it run more gracefully.")]),e._v(" "),t("h2",{attrs:{id:"here-is-transformed-project"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#here-is-transformed-project"}},[e._v("#")]),e._v(" Here is transformed project")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://user-images.githubusercontent.com/40830929/125884473-b89f344c-db98-4496-9d44-33b5e773c93d.png",alt:"image-20210716101939971"}})])])}),[],!1,null,null,null);n.default=o.exports}}]);